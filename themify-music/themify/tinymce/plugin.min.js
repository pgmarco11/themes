tinymce.PluginManager.add("themifyMenu",function(d,l){function h(){var c=d.settings.color_picker_callback;if(c)return function(){var b=this;c.call(d,function(c){b.value(c).fire("change")},b.value())}}function f(c){return{text:c.label,body:{type:c.id},onclick:function(){if(jQuery.isEmptyObject(c.fields)){var b={};b.selectedContent=d.selection.getContent();var k=wp.template("themify-shortcode-"+c.id);d.insertContent(k(b))}else{var g=[];jQuery.each(c.fields,function(c,a){"colorbox"==a.type?a.onaction=
h():"image"==a.type?a={type:"container",label:a.label,layout:"flex",direction:"row",items:[{type:"textbox",name:a.name},{type:"button",text:a.text,onclick:function(){var c=jQuery(this.$el),a=wp.media.frames.file_frame=wp.media({multiple:!1});a.on("select",function(){var b=a.state().get("selection").first().toJSON();c.prev().val(b.url)});a.open()}}]}:"iconpicker"==a.type&&(a={type:"container",label:a.label,layout:"flex",direction:"row",items:[{type:"textbox",name:a.name},{type:"button",text:a.text,
onclick:function(){var a=jQuery(this.$el);Themify_Icons.target=a.prev();Themify_Icons.showLightbox(Themify_Icons.target.val())}}]});g.push(a)});d.windowManager.open({title:c.label,body:g,onSubmit:function(b){b=this.toJSON();b.selectedContent=d.selection.getContent();var a=wp.template("themify-shortcode-"+c.id);d.insertContent(a(b))}})}}}}var e=[];jQuery.each(themifyEditor.shortcodes,function(c,b){b.id=c;if("object"==typeof b.menu){var d=[];jQuery.each(b.menu,function(c,b){b.id=c;d.push(f(b))});e.push({text:b.label,
menu:d})}else e.push(f(b))});d.addButton("btnthemifyMenu",{type:"menubutton",text:"",image:themifyEditor.editor.icon,tooltip:themifyEditor.editor.menuTooltip,menu:e})});

/*
 ThemifyGradient
 Enhanced version of ClassyGradient, with RGBA support

 Original script written by Marius Stanciu - Sergiu <marius@vox.space>
 Licensed under the MIT license https://vox.SPACE/LICENSE-MIT
 Version 1.1.1

*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,h,f){a instanceof String&&(a=String(a));for(var l=a.length,e=0;e<l;e++){var p=a[e];if(h.call(f,p,e,a))return{i:e,v:p}}return{i:-1,v:void 0}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,h,f){a!=Array.prototype&&a!=Object.prototype&&(a[h]=f.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};
$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,h,f,l){if(h){f=$jscomp.global;a=a.split(".");for(l=0;l<a.length-1;l++){var e=a[l];e in f||(f[e]={});f=f[e]}a=a[a.length-1];l=f[a];h=h(l);h!=l&&null!=h&&$jscomp.defineProperty(f,a,{configurable:!0,writable:!0,value:h})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,f){return $jscomp.findInternal(this,a,f).v}},"es6-impl","es3");
(function(a){a.ThemifyGradient=function(h,f){var l={gradient:"0% rgba(0,0,0, 1)|100% rgba(255,255,255,1)",width:200,height:15,point:8,angle:180,circle:!1,type:"linear",onChange:function(){},onInit:function(){}},e=a(h),p,r,q,t,w,v,x,y,u,n,g=[];this.settings={};this.__constructor=function(){this.settings=a.extend({},l,f);this.update();this.settings.onInit();return this};this.update=function(){this._setupPoints();this._setup();this._render()};this.getCSS=function(){var a=this.getCSSvalue();return"background-image: -moz-"+
a+";\n"+("background-image: -webkit-"+a+";\n")+("background-image: -o-"+a+";\n")+("background-image: -ms-"+a+";\n")+("background-image: "+a+";\n")};this.getCSSvalue=function(){var b=this.settings.angle+"deg,";"radial"===this.settings.type&&(b=this.settings.circle?"circle,":"");var k=[];a.each(g,function(a,b){k.push(b[1]+" "+b[0])});return this.settings.type+"-gradient("+b+k.join(", ")+")"};this.getArray=function(){return g};this.getString=function(){var b="";a.each(g,function(a,c){b+=c[0]+" "+c[1]+
"|"});return b=b.substr(0,b.length-1)};this.setType=function(a){this.settings.type=a;this.settings.onChange(this.getString(),this.getCSS(),this.getArray())};this.setAngle=function(a){this.settings.angle=a;this.settings.onChange(this.getString(),this.getCSS(),this.getArray())};this.setRadialCircle=function(a){this.settings.circle=a;this.settings.onChange(this.getString(),this.getCSS(),this.getArray())};this._setupPoints=function(){g=[];g=a.isArray(this.settings.gradient)?this.settings.gradient:this._getGradientFromString(this.settings.gradient)};
this._setup=function(){var b=this;e.empty();p=a('<div class="ThemifyGradient"></div>');r=a('<canvas class="canvas" width="'+this.settings.width+'" height="'+this.settings.height+'"></canvas>');p.append(r);u=r.get(0).getContext("2d");q=a('<div class="points"></div>');q.css("width",this.settings.width+Math.round(this.settings.point/2+1)+"px");p.append(q);t=a('<div class="gradient-pointer-info"></div>');t.append('<div class="gradient-pointer-arrow"></div>');p.append(t);w=a('<div class="content"></div>');
t.append(w);e.hover(function(){e.addClass("hover")},function(){e.removeClass("hover")});v=a('<div class="point-color"><div style="background-color: #00ff00"></div></div>');x=a('<input type="text" class="point-position"/>');y=a('<a href="#" class="gradient-point-delete"><i class="ti ti-close"></i></a>');w.append(v,'<span class="gradient_delimiter"></span>',x,'<span class="gradient_percent">%</span>',y);e.append(p);a(document).bind("click",function(){e.is(".hover")||t.hide("fast")});r.unbind("click").bind("click",
function(k){var c=r.offset(),d=k.pageX-c.left,d=Math.round(100*d/b.settings.width),m="rgba(0,0,0, 1)",e=999999999999;a.each(g,function(a,b){parseInt(b[0])<d&&d-parseInt(b[0])<e?(e=d-parseInt(b[0]),m=b[1]):parseInt(b[0])>d&&parseInt(b[0])-d<e&&(e=parseInt(b[0])-d,m=b[1])});g.push([d+"%",m]);g.sort(b._sortByPosition);b._render();a.each(g,function(a,c){c[0]==d+"%"&&b._selectPoint(q.find(".point:eq("+a+")"),!1)})});this.pointEvents()};this.pointEvents=function(){var b=this;e.delegate(".themify-color-picker",
"keyup",function(){var k=a(this).val();k||(k="fff");if(k=b.hexToRgb(k)){var c=a(this).data("opacity");"undefined"===typeof c&&(c=1);a(this).closest(".ThemifyGradient").find(".themify_current_point").css("backgroundColor","rgba("+k.r+","+k.g+","+k.b+","+c+")");b._renderCanvas()}});e.find(".point-position").bind("keyup focusout",function(k){var c=parseInt(a.trim(a(this).val()));isNaN(c)?c=0:0>c?c=Math.abs(c):98<=c&&(c=98);"focusout"!==k.type?(c=Math.round(c*b.settings.width/100),a(this).closest(".ThemifyGradient").find(".themify_current_point").css("left",
c),b._renderCanvas()):a(this).val(c)})};this._render=function(){this._initGradientPoints();this._renderCanvas()};this._initGradientPoints=function(){var b=this;q.empty();a.each(g,function(a,c){q.append('<div class="point" style="background-color: '+c[1]+"; left:"+parseInt(c[0])*b.settings.width/100+'px;"></div>')});q.find(".point").css("width",this.settings.point+"px").css("height",this.settings.point+"px").mouseup(function(){b._selectPoint(this,!1)}).draggable({axis:"x",containment:"parent",start:function(b,
c){a(c.helper[0]).find(".minicolors-swatch").trigger("mousedown.minicolors")},stop:function(b,c){a(c.helper[0]).find(".minicolors-swatch").trigger("mousedown.minicolors")},drag:function(a,c){b._selectPoint(this,!0);b._renderCanvas()}})};this.hexToRgb=function(a){a=a.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,b,d,m){return b+b+d+d+m+m});return(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null};this._selectPoint=function(b,
k){var c=this;n=a(b);n.parent().children().removeClass("themify_current_point");n.addClass("themify_current_point");var d=n.css("backgroundColor"),m=parseInt(n.css("left")),m=Math.round(m/this.settings.width*100),d=d.substr(4,d.length),d=d.substr(0,d.length-1);e.find(".point-color div").remove();var f=v.find(".themify-color-picker");1>f.length&&(f=a('<input type="text" class="themify-color-picker" />'),f.appendTo(v).minicolors({format:"rgb",opacity:!0,change:function(a,b){var d=c.hexToRgb(a);n.css("backgroundColor",
"rgba("+d.r+","+d.g+","+d.b+","+b+")");c._renderCanvas()}}));var d=n.css("backgroundColor").replace(/^rgba?\(|\s+|\)$/g,"").split(","),h=4===d.length?d.pop():1;f.val(this._rgbToHex(d)).attr("data-opacity",h).minicolors("settings",{value:this._rgbToHex(d)});x.val(m);y.unbind("click").bind("click",function(){1<g.length&&(g.splice(n.index(),1),c._render(),e.find(".gradient-pointer-info").hide("fast"));return!1});e.find(".gradient-pointer-info").css("marginLeft",parseInt(n.css("left"))-30+"px").show("fast",
function(){k||f.prev(".minicolors-swatch").trigger("mousedown.minicolors")})};this._renderCanvas=function(){var b=this;g=[];e.find(".point").each(function(k,c){var d=Math.round(parseInt(a(c).css("left"))/b.settings.width*100),m=a(c).css("backgroundColor");g.push([d+"%",m])});g.sort(b._sortByPosition);this._renderToCanvas();this.settings.onChange(this.getString(),this.getCSS(),this.getArray())};this._renderToCanvas=function(){var b=u.createLinearGradient(0,0,this.settings.width,0);a.each(g,function(a,
c){b.addColorStop(parseInt(c[0])/100,c[1])});u.clearRect(0,0,this.settings.width,this.settings.height);u.fillStyle=b;u.fillRect(0,0,this.settings.width,this.settings.height);this.settings.onChange(this.getString(),this.getCSS(),this.getArray())};this._getGradientFromString=function(b){var k=[];b=b.split("|");a.each(b,function(a,b){if("100"==b.substr(b.indexOf("%")-3,b.indexOf("%"))||"100%"==b.substr(b.indexOf("%")-3,b.indexOf("%")))var c="100%";else c=1<b.indexOf("%")?parseInt(b.substr(b.indexOf("%")-
2,b.indexOf("%"))):parseInt(b.substr(b.indexOf("%")-1,b.indexOf("%"))),c+="%";var d=b.replace(c,"");k.push([c,d])});return k};this._rgbToHex=function(a){function b(a){a=parseInt(a,10);if(isNaN(a))return"00";a=Math.max(0,Math.min(a,255));return"0123456789ABCDEF".charAt((a-a%16)/16)+"0123456789ABCDEF".charAt(a%16)}var c=a[1],d=a[2];return"#"+b(a[0])+b(c)+b(d)};this._sortByPosition=function(a,e){return parseInt(a[0])<parseInt(e[0])?-1:parseInt(a[0])>parseInt(e[0])?1:0};this._base64=function(a){for(var b=
"",c,d,e,f,h,g,l=0;l<a.length;)c=a.charCodeAt(l++),d=a.charCodeAt(l++),e=a.charCodeAt(l++),f=c>>2,c=(c&3)<<4|d>>4,h=(d&15)<<2|e>>6,g=e&63,isNaN(d)?h=g=64:isNaN(e)&&(g=64),b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(f)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(g);return b};return this.__constructor()};
a.fn.ThemifyGradient=function(h){return this.each(function(){if(void 0===a(this).data("ThemifyGradient")){var f=new a.ThemifyGradient(this,h);a(this).data("ThemifyGradient",f)}})}})(jQuery);

(function(b){if(0!==b("#page-builder.themify_write_panel").length){var a=themifybuilderapp;a.mode="skeleton";a.isPostSave=!1;a.render=function(){var d=new a.Collections.Rows(themifyBuilder.builder_data);a.Instances.Builder[0]=new a.Views.Builder({el:"#themify_builder_row_wrapper",collection:d});a.Instances.Builder[0].render();this.toolbar=new a.Views.Toolbar({el:"#tb_toolbar"});b("input#publish,input#save-post").on("click",function(d){a.isPostSave||(a.Utils.saveBuilder(!1).done(function(){ThemifyBuilderCommon.undoManager.instance.clear();
a.isPostSave=!0;b(d.currentTarget).trigger("click")}),d.preventDefault())});b("#themify_builder_switch_frontend").on("click",this.switchFrontEnd);b('<a href="#" id="themify_builder_switch_frontend_button" class="button themify_builder_switch_frontend">'+themifyBuilder.i18n.switchToFrontendLabel+"</a>").on("click",this.switchFrontEnd).appendTo("#postdivrich #wp-content-media-buttons");a.Views.bindEvents();a.Forms.bindEvents()};a.UpdateQueryString=function(b,a,c){c||(c=window.location.href);var d=RegExp("([?|&])"+
b+"=.*?(&|#|$)(.*)","gi");if(d.test(c))return void 0!==a&&null!==a?c.replace(d,"$1"+b+"="+a+"$2$3"):c.replace(d,"$1$3").replace(/(&|\?)$/,"");if(void 0!==a&&null!==a){var d=-1!==c.indexOf("?")?"&":"?",e=c.split("#");return c=e[0]+d+b+"="+a,e[1]&&(c+="#"+e[1]),c}return c};a.switchFrontEnd=function(d){d.preventDefault();b("#themify_builder_row_wrapper").is(":visible")?a.Utils.saveBuilder(!0,function(){ThemifyBuilderCommon.undoManager.instance.clear();a.redirectToFrontend()}):a.redirectToFrontend()};
a.redirectToFrontend=function(b){b=a.UpdateQueryString("builder_switch_frontend",1);window.location=b};b(function(){a.render();if("function"==typeof window.icl_copy_from_original){var b=window.icl_copy_from_original;window.icl_copy_from_original=function(a,c){b(a,c);jQuery.ajax({url:ajaxurl,type:"POST",data:{action:"themify_builder_icl_copy_from_original",source_page_id:c,source_page_lang:a},success:function(b){"-1"!=b&&jQuery("#page-builder .themify_builder.themify_builder_admin").empty().append(b).contents().unwrap()}})}}});
b(window).load(function(){function a(){c.width(c.width());h=e.offset().top;k=Math.round(b("#page-builder").offset().top);f.height(c.outerHeight(!0));b(window).scroll(function(){g&&clearTimeout(g);g=setTimeout(m,15)}).resize(function(){h=e.offset().top;c.width(b("#page-builder .themify_builder_admin").width()).css("top",l.outerHeight(!0));f.height(c.outerHeight(!0))})}function m(){g=null;var a=k+b("#page-builder").height(),d=b(this).scrollTop();d>h&&d<a?(c.addClass("tb_toolbar_fixed").css("top",n),
f.css("display","block")):(c.removeClass("tb_toolbar_fixed").css("top",0),f.css("display","none"))}var c=b("#tb_toolbar"),f=b("#themify_builder_module_tmp"),e=b("#tb_scroll_anchor"),h=0,g=null,k=0,l=b("#wpadminbar"),n=l.outerHeight(!0);if(0<c.length)if(c.is(":visible"))a();else b(".themify-meta-box-tabs a").one("click",function(){"page-buildert"==b(this).attr("id")&&a()});sessionStorage.getItem("focusBackendEditor")&&(b("#page-buildert").trigger("click"),b("html, body").animate({scrollTop:b("#tb_toolbar").offset().top-
b("#wpadminbar").height()},2E3),sessionStorage.removeItem("focusBackendEditor"))})}})(jQuery);
